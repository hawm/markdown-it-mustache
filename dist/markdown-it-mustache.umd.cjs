(function(a,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(a=typeof globalThis<"u"?globalThis:a||self,f(a.MarkdownItMustache={}))})(this,function(a){"use strict";const k=[35,94],g=47,M=[33,38,62];function d(e,r,t,i){for(let n=r;n<t;n++)if(!i(e.charCodeAt(n)))return!1;return!0}function _(e,r,t,i=!1){let n,s,o;for(n=r;n<t-5;n++){if(e.charCodeAt(n)===123&&e.charCodeAt(n+1)===123){o=!0;break}if(i||e.charCodeAt(n)===10)return!1}if(!o)return!1;for(s=n+2;s<=t;s++)if(e.charCodeAt(s-1)==125&&e.charCodeAt(s)==125)return{start:n,end:s};return!1}function m(e,r,t,i=!1){const n=_(e,r,t,i);if(!n)return!1;const s=e.slice(n.start,n.end+1),o=s.slice(2,-2),c=o.charCodeAt(0),u=k.includes(c),h=u?!1:c===g,l=u?1:h?-1:0,p=o.slice(l?1:0).trim(),O=l!==0||M.includes(c)?String.fromCharCode(c):"";return{opening:u,closing:h,nesting:l,mark:O,name:p,content:o,raw:s,pos:n}}function b(e,r,t,i){let n,s,o,c,u=0;for(o=t;o<=i&&(n=e.bMarks[o]+e.tShift[o],s=e.eMarks[o],!(n<s&&e.sCount[o]<e.blkIndent));o++)if(!(e.sCount[o]-e.blkIndent>=4)&&(c=m(e.src,n,s,!0),!!c&&d(e.src,c.pos.end+1,e.eMarks[o],e.md.utils.isWhiteSpace)))if(c.closing&&c.name===r.name){if(u===0){c.line=o,c.block=!0;break}u--}else c.opening&&c.name===r.name&&u++;return c}function C(e,r,t,i){const n=e.bMarks[r]+e.tShift[r],s=e.eMarks[r],o=m(e.src,n,s,!0);if(!o||!o.opening||!d(e.src,o.pos.end+1,s,e.md.utils.isWhiteSpace))return!1;const c=b(e,o,r+1,t);if(!c)return!1;if(!i){const u=e.push("mustache_open","",1);u.block=!0,u.meta={tag:o},u.map=[r,c.line];const h=e.parentType,l=e.lineMax;e.parentType="mustache_block",e.lineMax=c.line,e.md.block.tokenize(e,r+1,c.line),e.parentType=h,e.lineMax=l;const p=e.push("mustache_close","",-1);p.block=!0}return e.line=c.line+1,!0}function T(e,r,t,i,n){const s=e[r],o=s.tag||"div";if(s.nesting===-1)return`</${o}>`;const c=s.meta.tag;return`<${o} class="mustache mustache-block" data-mustache-name=${c.name}   data-mustache-mark=${c.mark}>`}function $(e,r=T){e.block.ruler.after("fence","mustache_block",C,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.mustache_open=r,e.renderer.rules.mustache_close=r}function x(e,r,t,i){let n,s=0;for(let o=t;o<i-5;o=n.pos.end+1){if(n=m(e,o,i),!n)return!1;if(n.closing&&n.name===r.name){if(s===0)return n;s--}else n.opening&&n.name===r.name&&s++}return!1}function I(e,r){let t;if(e.src.charCodeAt(e.pos)!==123)return!1;const i=m(e.src,e.pos,e.posMax);if(!i)return!1;if(i.nesting===0)return r||(t=e.push("mustache_inline","span",0),t.meta={tag:i}),e.pos=i.pos.end+1,!0;if(i.closing)return r||(t=e.push("mustache_inline","span",0),t.meta={tag:i}),e.pos=i.pos.end+1,!0;const n=x(e.src,i,i.pos.end+1,e.posMax);return n?(r||(t=e.push("mustache_inline_open","span",1),t.meta={tag:i},e.pos=i.pos.end+1,e.posMax=n.pos.start,e.md.inline.tokenize(e),e.pos=n.pos.end+1,e.posMax=e.src.length,e.push("mustache_inline_close","span",-1)),e.pos=n.pos.end+1,!0):(r||(t=e.push("mustache_inline","span",0),t.meta={tag:i}),e.pos=i.pos.end+1,!0)}function y(e,r,t,i,n){const s=e[r],o=s.tag||"span",c=s.meta.tag;return`<${o} class="mustache mustache-inline" data-mustache-name="${c.name}"   data-mustache-mark="${c.mark}"></${o}>`}function A(e,r,t,i,n){const s=e[r],o=s.tag||"span";if(s.nesting===-1)return`</${o}>`;const c=s.meta.tag;return`<${o} class="mustache mustache-inline mustache-inline-block"   data-mustache-name="${c.name}" data-mustache-mark=${c.mark}>`}function S(e,r=y,t=A){e.inline.ruler.push("mustache_inline",I),e.renderer.rules.mustache_inline=r,e.renderer.rules.mustache_inline_open=t,e.renderer.rules.mustache_inline_close=t}a.mustacheBlock=$,a.mustacheInline=S,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
